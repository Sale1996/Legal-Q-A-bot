<div class="pt-5 px-5 header-legal-question">
    <div class="page-header">
      <h1>Choose what do you want to find:</h1>
    </div>
</div>

<form class="content-align-form-ontology-entity" [formGroup]="chooseEntityForm" (ngSubmit)="onSubmit()">
        <ng-container formGroupName="entity">
          <div class="form-group selectEntity">
            <ng-container *ngIf="entities$ | async as entities; else loading">
            <select (change)="selectEntity($event.target.value)" type="text" formControlName="legalEntityId" class="form-control" required>
              <option *ngFor="let e of entities" value="{{e.legalEntityId}}">{{e.legalEntityName}}</option>
            </select>
            </ng-container>
          </div>
        </ng-container>
</form>


<ng-container *ngIf="selectedEntity != undefined">
  <div class="pt-5 px-5 header-legal-question">
      <div class="page-header">
        <h2>Select question of selected entity:</h2>
      </div>
  </div>
  <form class="content-align-form-ontology-entity" [formGroup]="chooseQuestionForm" (ngSubmit)="onSubmit()">
          <ng-container formGroupName="question">
            <div class="form-group selectQuestion">
              <ng-container *ngIf="questions$ | async as questions; else loading">
              <select (change)="selectQuestion($event.target.value)" type="text" formControlName="sparqlQuestionId" class="form-control" required>
                <option *ngFor="let q of questions" value="{{q.sparqlQuestionId}}">{{q.queryText}}</option>
              </select>
              </ng-container>
            </div>
          </ng-container>
  </form>
</ng-container>

<ng-container *ngIf="selectedQuestion != undefined">
  <div class="pt-5 px-5 header-legal-question">
      <div class="page-header">
        <h3>Fill the parameters:</h3>
      </div>
  </div>
  <form class="content-align-form-ontology-entity selectEntity" [formGroup]="findAnswerForm" (ngSubmit)="getAnswer()">
      <div class="row mt-4 px-5">
        <div class="col-md-12">
          <div formArrayName="parameters">
            <div [formGroupName]="i" *ngFor="let control of findAnswerForm.get('parameters').controls; index as i">
                <div class="form-group" class="col-form-label col-form-label-sm">
                  <h5>{{control.get('questionProperty').value.questionPropertyName | json}}</h5>
                  <ng-container [ngSwitch]="control.get('questionProperty').value.questionPropertyType">
                    <input *ngSwitchCase='"Text"' class="form-control" type="text" formControlName="textInput">
                    <input *ngSwitchCase='"Number"' class="form-control" type="number" formControlName="numberInput">
                    <input *ngSwitchCase='"Boolean"' class="form-control" type="checkbox" formControlName="booleanInput">
                    <ng-container *ngSwitchCase='"EntityConnection"'>
                      <div class="form-group selectEntity">
                        <ng-container *ngIf="entities$ | async as entities; else loading">
                        <select (change)="selectEntity($event.target.value)" type="text" class="form-control form-control-sm" required>
                          <option *ngFor="let e of entities" value="{{e.entityId}}">{{e.entityName}}</option>
                        </select>
                        </ng-container>
                      </div>
                    </ng-container>
                 </ng-container>
                </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row pt-2 pb-5 px-5">
        <div class="col-md-12">
          <button type="submit" [disabled]="!findAnswerForm.valid" class="btn btn-primary">Find answer</button>
        </div>
      </div>
  </form>
</ng-container>

<svg width="0" height="0" class="hidden d-none">
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" id="Close_Icon">
      <path d="M22.9 14.5l-1.4-1.4-3.5 3.5-3.5-3.5-1.4 1.4 3.5 3.5-3.5 3.5 1.4 1.4 3.5-3.5 3.5 3.5 1.4-1.4-3.5-3.5z">
      </path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" id="Checkmark_Icon">
      <path d="M25.3 11.4L15 21.7l-4.3-4.3-1.4 1.4 5 5 .7.7.7-.7 11-11-1.4-1.4z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" id="Delete_Icon">
      <path d="M22 13v-2h-8v2h-3v2h2v10h10V15h2v-2h-3zm-1 10h-6v-8h6v8z"></path>
    </symbol>
    <symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" id="Search_Icon">
      <path
        d="M31.6 30.2l-4.3-4.3c.7-1 1.1-2.2 1.1-3.5 0-3.3-2.7-6-6-6s-6 2.7-6 6 2.7 6 6 6c1.3 0 2.5-.4 3.5-1.1l4.3 4.3 1.4-1.4zm-9.2-3.8c-2.2 0-4-1.8-4-4s1.8-4 4-4 4 1.8 4 4-1.8 4-4 4z">
      </path>
    </symbol>
  </svg>